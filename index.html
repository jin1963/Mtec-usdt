<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kaojino MTEC Package Auto-Stake</title>

  <link rel="stylesheet" href="style.css" />

  <!-- ethers.js (UMD) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <!-- load config before app -->
  <script src="config.js"></script>
  <script src="app.js"></script>
</head>

<body>
  <div class="wrap">

    <div class="navbar">
      <div>
        <div class="brandTitle">Kaojino DeFi</div>
        <div class="brandSub">MTEC Package Auto-Stake • Referral USDT (3 Levels)</div>
      </div>
      <button id="btnConnect">Connect Wallet</button>
    </div>

    <h1 class="pageTitle">ซื้อแพ็คเกจ MTEC (จ่าย USDT) และ Auto-Stake</h1>
    <p class="pageDesc">
      ระบบจะจ่ายค่าแนะนำ <b>เป็น USDT</b> (10% / 3% / 2%) “หักจากผู้ซื้อ” และจ่ายผลตอบแทน <b>APY เป็น MTEC</b> เมื่อครบสัญญา
    </p>

    <!-- BALANCES -->
    <div class="card">
      <div class="rateBox">
        <span class="muted">สถานะกระเป๋า</span>
        <strong class="rateStrong" id="netName">BSC Mainnet</strong>
      </div>

      <div class="balances">
        <div class="balRow">
          <span class="muted">Wallet:</span>
          <span class="mono" id="walletAddr">-</span>
        </div>
        <div class="balRow">
          <span class="muted">USDT Balance:</span>
          <span class="mono"><span id="usdtBalance">-</span> USDT</span>
        </div>
        <div class="balRow">
          <span class="muted">MTEC Balance:</span>
          <span class="mono"><span id="mtecBalance">-</span> MTEC</span>
        </div>
        <div class="balRow">
          <span class="muted">Contract:</span>
          <span class="mono" id="contractAddr">-</span>
        </div>
      </div>

      <div id="txMessage" class="msg" aria-live="polite"></div>
    </div>

    <!-- PACKAGES -->
    <div class="card">
      <div class="rateBox">
        <span class="muted">เลือกแพ็คเกจ</span>
        <strong class="rateStrong" id="paramsBox">-</strong>
      </div>

      <div class="hint" id="refHint"></div>

      <div id="packages" class="packagesWrap">
        <!-- injected by app.js -->
      </div>

      <div class="btnRow">
        <button id="btnReloadPkgs" class="btnOutline">Reload Packages</button>
        <button id="btnApprove" class="btnOutline">Approve USDT (Optional)</button>
      </div>

      <div class="hint">
        * ปุ่ม Approve เป็นตัวเลือก: ระบบจะ auto-approve ให้อัตโนมัติเมื่อจำเป็นตอนกดซื้อ
      </div>
    </div>

    <!-- MY STAKES -->
    <div class="card">
      <div class="rateBox">
        <span class="muted">My Stakes</span>
        <strong class="rateStrong">รายการ stake ของคุณ</strong>
      </div>

      <div id="stakes" class="stakesWrap">
        <!-- injected by app.js -->
      </div>

      <div class="btnRow">
        <button id="btnReloadStakes" class="btnPrimary">Reload My Stakes</button>
      </div>
    </div>

    <!-- REFERRAL -->
    <div class="card">
      <h2 class="sectionTitle">Referral Link</h2>
      <p class="muted">แชร์ลิงก์นี้ให้เพื่อน เพื่อให้ระบบผูก ref อัตโนมัติ</p>

      <div class="refRow">
        <input id="refLink" class="mono" readonly />
        <button id="btnCopy" class="btnOutline">Copy</button>
      </div>

      <div class="hint">
        หมายเหตุ: ระบบจะผูก ref “ครั้งแรกเท่านั้น” ถ้าผู้ใช้เคยซื้อแล้วจะเปลี่ยน ref ไม่ได้
      </div>
    </div>

    <div class="footer">
      <div>Network: BNB Smart Chain (Mainnet)</div>
      <div>ต้องมี BNB เล็กน้อยสำหรับค่า Gas</div>
    </div>

  </div>

  <!-- เพิ่ม style เล็กน้อยให้ grid packages/stakes (ไม่กระทบธีมหลัก) -->
  <style>
    .packagesWrap, .stakesWrap {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    @media (min-width: 720px) {
      .packagesWrap { grid-template-columns: 1fr 1fr; }
      .stakesWrap { grid-template-columns: 1fr 1fr; }
    }
    .pkgCard, .stakeCard {
      border: 1px solid var(--border-soft);
      border-radius: 16px;
      padding: 14px;
      background: #fff;
    }
    .pkgTop, .stakeTop {
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin-bottom: 10px;
    }
    .badge {
      display:inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--blue-light);
      color: var(--blue-dark);
      font-weight: 700;
      font-size: 12px;
      border: 1px solid var(--border-soft);
    }
    .kv { display:flex; justify-content:space-between; gap:10px; padding: 6px 0; font-size: 14px; }
    .kv .k { color: var(--text-muted); }
    .kv .v { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
    .smallBtnRow { display:flex; gap:10px; margin-top: 10px; }
    .smallBtnRow button { padding: 10px; border-radius: 12px; }
  </style>
</body>
</html>
